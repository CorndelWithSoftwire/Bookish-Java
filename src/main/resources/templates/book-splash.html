<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <title>Bookish - Home</title>

    <!--    <link rel="stylesheet" href="/styles/general.css"/>-->
    <link rel="stylesheet" href="/styles/navbar.css"/>
    <link rel="stylesheet" href="/styles/book-splash.css"/>
    <!--    <link rel="stylesheet" href="/styles/index.css"/>-->
</head>
<body>
<div th:replace="fragments/navbar :: navbar">
    <!-- This element is replaced by the HTML in fragments/navbar.html -->
</div>
<h3>Book page- under construction</h3>
<!--admin button -->
<div class="form-check form-switch">
    <input class="form-check-input" type="checkbox" id="flexSwitchCheckDefault" >
    <label class="form-check-label" for="flexSwitchCheckDefault">Admin</label>
</div>

<div class="book-splash-container">
    <div class="book-title-container">
        <h1 th:text="${bookSplashModel.getBook().getTitle()}"></h1>
        <p>
            <span class="info-field">By </span>
            <a th:href="${'/library/filterid?id='}+${bookSplashModel.getBook().getAuthorId()}" type="${book.getTitle}" th:text="${bookSplashModel.getBook().getAuthorName()}"></a>
        </p>
    </div>
    <div class="info-qr-container">
        <div class="book-info-container">
            <table>
                <tr>
                    <td class="info-field">Published: </td>
                    <td th:text="${bookSplashModel.getBook().getPublishedDate()}"></td>
                </tr>
                <tr>
                    <td class="info-field">Publisher: </td>
                    <td th:text="${bookSplashModel.getBook().getPublisher()}"></td>
                </tr>
                <tr>
                    <td class="info-field">Genre: </td>
                    <td th:text="${bookSplashModel.getBook().getGenre()}"></td>
                </tr>
                <tr>
                    <td class="info-field">ISBN: </td>
                    <td th:text="${bookSplashModel.getBook().getIsbn()}"></td>
                </tr>
                <tr>
                    <td class="info-field">Available copies in library: </td>
                    <td th:text="${bookSplashModel.getBook().getNumberOfCopies()}"></td>
                </tr>
            </table>
        </div>

        <!--    <img src="https://www.uoduckstore.com/TDS%20Product%20Images/Laminated%20Anatomy%20Poster_99.jpg" alt="Cover not available" width="10%" height="10%" class="book-cover"/>-->

        <div class="qr-code-container">
            <img th:src="${'http://api.qrserver.com/v1/create-qr-code/?color=000000&amp;bgcolor=FFFFFF&amp;data=' + bookSplashModel.getBook().toString() + '&amp;qzone=1&amp;margin=0&amp;size=200x200&amp;ecc=L'}" alt="qr code" class="qr-code" />
        </div>
    </div>

</div>

<div class="edit-book-container">
    <form id="formForEditBook" th:action="@{/book-splash/edit-book}" method="post">
        <h2>Edit book:</h2>
        <div class="form-group row" hidden>
            <label form="inputId" class="col-sm-2 col-form-label">Id</label>
            <div class="col-sm-10">
                <input type="text" name="id" class="form-control" id="inputId" th:value="${bookSplashModel.getBook().getId()}" th:placeholder="${bookSplashModel.getBook().getId()}">
            </div>
        </div>
        <div class="form-group row">
            <label form="inputTitle" class="col-sm-2 col-form-label">Title</label>
            <div class="col-sm-10">
                <input type="text" name="title" class="form-control" id="inputTitle" th:value="${bookSplashModel.getBook().getTitle()}" th:placeholder="${bookSplashModel.getBook().getTitle()}">
            </div>
        </div>
        <div class="form-group row">
            <label form="inputISBN" class="col-sm-2 col-form-label">ISBN</label>
            <div class="col-sm-10">
                <input type="text" name="isbn" class="form-control" id="inputISBN" th:value="${bookSplashModel.getBook().getIsbn()}" th:placeholder="${bookSplashModel.getBook().getIsbn()}">
            </div>
        </div>
        <div class="form-group row">
            <label form="inputPublishedDate" class="col-sm-2 col-form-label">Published Date</label>
            <div class="col-sm-10">
                <input type="text" name="publishedDate" class="form-control" id="inputPublishedDate" th:value="${bookSplashModel.getBook().getPublishedDate()}" th:placeholder="${bookSplashModel.getBook().getPublishedDate()}">
            </div>
        </div>
        <div class="form-group row">
            <label form="inputPublisher" class="col-sm-2 col-form-label">Publisher</label>
            <div class="col-sm-10">
                <input type="text" name="publisher" class="form-control" id="inputPublisher" th:value="${bookSplashModel.getBook().getPublisher()}" th:placeholder="${bookSplashModel.getBook().getPublisher()}">
            </div>
        </div>
        <div class="form-group row">
            <label form="inputGenre" class="col-sm-2 col-form-label">Genre</label>
            <div class="col-sm-10">
                <input type="text" name="genre" class="form-control" id="inputGenre" th:value="${bookSplashModel.getBook().getGenre()}" th:placeholder="${bookSplashModel.getBook().getGenre()}">
            </div>
        </div>
        <div class="form-group row">
            <label form="inputNumberOfCopies" class="col-sm-2 col-form-label">Number Of Copies</label>
            <div class="col-sm-10">
                <input type="text" name="numberOfCopies" class="form-control" id="inputNumberOfCopies" th:value="${bookSplashModel.getBook().getNumberOfCopies()}" th:placeholder="${bookSplashModel.getBook().getNumberOfCopies()}">
            </div>
        </div>
        <div class="form-group row">
            <label form="inputAuthorID" class="col-sm-2 col-form-label">Author ID</label>
            <div class="col-sm-10">
                <input type="text" name="authorId" class="form-control" id="inputAuthorID" th:value="${bookSplashModel.getBook().getAuthorId()}" th:placeholder="${bookSplashModel.getBook().getAuthorId()}">
            </div>
        </div>
        <!--        <input type="submit" value="Add book" />-->
        <input type="submit" class="col-sm-12 btn btn-primary" id="editBookInput" />
    </form>
</div>
</body>
<script>
    const lastPart = window.location.href.split("?").pop();
    console.log(lastPart)

    $(document).ready(function(){

        // for accessing the links
        $(".delete-button a").click(function(event){
            if(document.getElementById('flexSwitchCheckDefault').checked) {
                console.log('checkbox is checked');
                return true;
            }
            console.log('admin right not enabled');
            event.preventDefault();
        });

        // for accessing the form and submit button
        $("#flexSwitchCheckDefault").on('change', function() {
            localStorage.input = $(this).is(':checked');

            if ($(this).is(':checked')) {
                alert("Admin right enabled");
                $("#editBookInput").removeClass("disabled")
                $('#formForEditBook').show();
            }
            else {
                alert("Admin right disabled");
                $("#editBookInput").addClass("disabled");
                $('#formForEditBook').hide();
            }
        });
    });

    // checkbox persistence
    $(function(){
        const test = localStorage.input === 'true' ? true : false;
        $('#flexSwitchCheckDefault').prop('checked', test);
        console.log("Admin right: " +$("#flexSwitchCheckDefault").is(':checked'));

        if (! $("#flexSwitchCheckDefault").is(':checked')) {
            // hide content on load
            $('#formForEditBook').hide();
        }
    });
</script>

</html>